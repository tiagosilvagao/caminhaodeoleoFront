(function(){"use strict";this.$evt=function(t){var e=this;e.$eval||(e=angular.element(event.target).scope()),e.$eval(t)}.bind(this),this.cronapi={};var getDatasource=function(t){return"string"==typeof t?window[t]:t};this.cronapi.doEval=function(t){return t},this.cronapi.evalInContext=function(js){var result=eval("this.cronapi.doEval("+js+")");if(result&&result.commands)for(var i=0;i<result.commands.length;i++){var func=eval(result.commands[i].function);func.apply(this,result.commands[i].params)}if(result&&result.value)return result.value},this.cronapi.client=function(pack){return{attr:function(){return this},run:function(){var bk=eval("blockly."+pack);return bk.apply(this,arguments)}.bind(this)}};var serverMap={};this.cronapi.server=function(t){var e=!1;return{attr:function(){return e=!0,this},run:function(){for(var n=t,i=0;i<arguments.length;i++)n+=String(arguments[i]);if(e){if(serverMap.hasOwnProperty(n))return"$$loading"!=serverMap[n]?serverMap[n]:"";serverMap[n]="$$loading"}var a=t.split("."),r=a[a.length-1];a.pop();for(var o=a.join("."),c=o+":"+r,s=function(t){this.safeApply(function(){e&&(serverMap[n]=t)})}.bind(this),l=function(t){this.safeApply(function(){e&&(serverMap[n]=t)})}.bind(this),p=[c,l,s],i=0;i<arguments.length;i++)p.push(arguments[i]);this.cronapi.util.makeCallServerBlocklyAsync.apply(this,p)}.bind(this)}},this.cronapi.conversion={},this.cronapi.conversion.asciiToBinary=function(t){var e="";if(t.length>0)for(var n=0;n<t.length;n++)for(var i=t.charCodeAt(n),a=7;a>=0;a--)e+=i>>a&1;return e},this.cronapi.conversion.toBoolean=function(t){return this.cronapi.internal.parseBoolean(t)},this.cronapi.conversion.toBytes=function(t){return t?t.toString():""},this.cronapi.conversion.chrToAscii=function(t){return t?t.charCodeAt(0):null},this.cronapi.conversion.stringToJs=function(t){return this.cronapi.internal.stringToJs(t)},this.cronapi.conversion.stringToDate=function(value){var pattern=/^\s*(\d+)[\/\.-](\d+)[\/\.-](\d+)(\s(\d+):(\d+):(\d+))?\s*$/;if(value){if(value instanceof Date)return value;if(pattern.test(value)){var splited=pattern.exec(value),userLang=(navigator.language||navigator.userLanguage).split("-")[0];if("pt"==userLang||"en"==userLang){var functionToCall=eval(userLang+"Date");return functionToCall(splited)}return new Date(value)}return new Date(value)}return null},this.cronapi.conversion.intToHex=function(t){return Number(t).toString(16).toUpperCase()},this.cronapi.conversion.toLong=function(t){return parseInt(t)},this.cronapi.conversion.toString=function(t){if(t){return new String(t).toString()}return""},this.cronapi.util={},this.cronapi.util.callServerBlocklyAsync=function(t,e,n,i){var a="api/cronapi/call/body/#classNameWithMethod#/".replace("#classNameWithMethod#",t),r=(this.cronapi.$scope.http,[]);$(arguments).each(function(){r.push(this)});var o="";window.uToken&&(o=window.uToken);var c={fields:e,inputs:r.slice(4)},s=this.cronapi.internal.getAddressWithHostApp(a);$.ajax({type:"POST",url:s,dataType:"html",data:JSON.stringify(c),headers:{"Content-Type":"application/json","X-AUTH-TOKEN":o,toJS:!0},success:n,error:i})},this.cronapi.util.getScreenFields=function(){var t={};for(var e in this.cronapi.$scope)this.cronapi.$scope[e]&&this.cronapi.$scope[e].constructor&&"DataSet"==this.cronapi.$scope[e].constructor.name&&(t[e]={},t[e].active=this.cronapi.$scope[e].active);for(var e in this.cronapi.$scope.vars)this.cronapi.$scope.vars[e]&&(t.vars||(t.vars={}),t.vars[e]=this.cronapi.$scope.vars[e]);for(var e in this.cronapi.$scope.params)this.cronapi.$scope.params[e]&&(t.params||(t.params={}),t.params[e]=this.cronapi.$scope.params[e]);return t},this.cronapi.util.makeCallServerBlocklyAsync=function(blocklyWithFunction,callbackSuccess,callbackError){var fields=this.cronapi.util.getScreenFields(),paramsApply=[];paramsApply.push(blocklyWithFunction),paramsApply.push(fields),paramsApply.push(function(data){var result=this.cronapi.evalInContext(data);"string"==typeof callbackSuccess?eval(callbackSuccess)(result):callbackSuccess&&callbackSuccess(result)}.bind(this)),paramsApply.push(function(data,status,errorThrown){var message=this.cronapi.internal.getErrorMessage(data.responseText,errorThrown);"string"==typeof callbackError?eval(callbackError)(message):callbackError?callbackError(message):this.cronapi.$scope.Notification.error(message)}.bind(this)),$(arguments).each(function(t){t>=3&&paramsApply.push(this)}),this.cronapi.util.callServerBlocklyAsync.apply(this,paramsApply)},this.cronapi.util.callServerBlocklyNoReturn=function(){this.cronapi.util.callServerBlockly.apply(this,arguments)},this.cronapi.util.throwException=function(t){throw t},this.cronapi.util.createException=function(t){return t},this.cronapi.util.callServerBlockly=function(t){for(var e="api/cronapi/call/body/#classNameWithMethod#/".replace("#classNameWithMethod#",t),n=[],i=this.cronapi.util.getScreenFields(),a={fields:i,inputs:n},r=1;r<arguments.length;r++)n.push(arguments[r]);var o="";window.uToken&&(o=window.uToken);var c=this.cronapi.internal.getAddressWithHostApp(e),s=$.ajax({type:"POST",url:c,dataType:"html",data:JSON.stringify(a),async:!1,headers:{"Content-Type":"application/json","X-AUTH-TOKEN":o,toJS:!0}});if(200!=s.status){var l=this.cronapi.internal.getErrorMessage(s.responseText,s.statusText);throw this.cronapi.$scope.Notification.error(l),l}return s.responseJSON?s.responseJSON:this.cronapi.evalInContext(s.responseText)},this.cronapi.util.executeJavascriptNoReturn=function(value){eval(value)},this.cronapi.util.downloadFile=function(t){var e=this.cronapi.internal.getAddressWithHostApp(t);this.cronapi.screen.openUrl(e,"_blank",0,0)},this.cronapi.util.executeJavascriptNoReturn=function(value){eval(value)},this.cronapi.util.executeJavascriptReturn=function(value){return eval(value)},this.cronapi.util.openReport=function(t){this.cronapi.$scope.getReport(t)},this.cronapi.util.executeAsynchronous=function(t){setTimeout(t,0)},this.cronapi.util.scheduleExecution=function(t,e,n,i){var a=1;"seconds"==i?a=1e3:"minutes"==i?a=6e4:"hours"==i&&(a=36e5),e*=a,n*=a;var r=-1,o=setTimeout(function(){t(),r=setInterval(t,n)}.bind(this),e);this.$on("$destroy",function(){try{clearTimeout(o)}catch(t){}try{clearInterval(r)}catch(t){}})},this.cronapi.util.openReport=function(t,e){this.cronapi.$scope.getReport(t,e)},this.cronapi.screen={},this.cronapi.screen.fieldFromScreen=function(t){return t},this.cronapi.screen.changeValueOfField=function(t,e){try{this.__tempValue=e;var n=new Function("this."+t+" = this.__tempValue;");this.safeApply(n.bind(this))}catch(t){}},this.cronapi.screen.getValueOfField=function(field){try{return field&&field.length>0?field.indexOf(".active.")>-1?eval(field):eval("this."+field):""}catch(t){alert(t)}},this.cronapi.screen.createScopeVariable=function(t,e){this.cronapi.$scope.vars[t]=e},this.cronapi.screen.getScopeVariable=function(t){return this.cronapi.$scope.vars[t]},this.cronapi.screen.notify=function(t,e){null!=e&&void 0!=e||(e=""),this.cronapi.$scope.Notification({message:e.toString()},t)},this.cronapi.screen.datasourceFromScreen=function(t){return t},this.cronapi.screen.startInsertingMode=function(t){getDatasource(t).$apply(function(){getDatasource(t).startInserting()})},this.cronapi.screen.startEditingMode=function(t){getDatasource(t).$apply(new function(){getDatasource(t).startEditing()})},this.cronapi.screen.previusRecord=function(t){getDatasource(t).$apply(new function(){getDatasource(t).previous()})},this.cronapi.screen.nextRecord=function(t){getDatasource(t).$apply(new function(){getDatasource(t).next()})},this.cronapi.screen.removeRecord=function(t){getDatasource(t).$apply(new function(){getDatasource(t).removeSilent()})},this.cronapi.screen.refreshActiveRecord=function(t){getDatasource(t).refreshActive()},this.cronapi.screen.hasNextRecord=function(t){return getDatasource(t).hasNext()},this.cronapi.screen.quantityRecords=function(t){return getDatasource(t).data.length},this.cronapi.screen.post=function(t){return getDatasource(t).postSilent()},this.cronapi.screen.filter=function(t,e){getDatasource(t).filter("/"+e)},this.cronapi.screen.changeView=function(t,e){try{var n="";if(void 0!==e)for(var i in Object.keys(e)){var a=Object.keys(e[i])[0],r=String(Object.values(e[i])[0]);null!=n&&(n+="&"),n+=encodeURIComponent(a)+"="+encodeURIComponent(r)}window.location.hash=t+(n?"?"+n:"")}catch(t){alert(t)}},this.cronapi.screen.openUrl=function(t,e,n,i){try{var a="_self",r="";e&&"true"==e.toString().toLowerCase()&&(a="_blank"),n&&(r+="width="+n+","),i&&(r+="height="+i+","),window.open(t,a,r)}catch(t){alert(t)}},this.cronapi.screen.getParam=function(t){try{for(var e,n=[],i=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),a=0;a<i.length;a++)e=i[a].split("="),n.push(e[0]),n[e[0]]=e[1];if(void 0!==n[t])return decodeURIComponent(n[t])}catch(t){}return null},this.cronapi.screen.confimDialog=function(t){return confirm(t)},this.cronapi.screen.createDefaultModal=function(t,e,n,i,a,r,o){$("#modalTemplateTitle").text(t),$("#modalTemplateBody").text(e),$("#modalTemplateCancel").text(n),$("#modalTemplateSave").text(i),$("#modalTemplateClose").unbind("click"),$("#modalTemplateClose").click(o),$("#modalTemplateCancel").unbind("click"),$("#modalTemplateCancel").click(r),$("#modalTemplateSave").unbind("click"),$("#modalTemplateSave").click(a),$("#modalTemplate").show()},this.cronapi.screen.showModal=function(t){try{$("#"+t).modal("show")}catch(e){$("#"+t).show()}},this.cronapi.screen.setActiveTab=function(t){this.cronapi.$scope.safeApply(function(){void 0===$("#"+t).attr("data-target")?$('[data-target="#'+t+'"]').tab("show"):$("#"+t).tab("show")})},this.cronapi.screen.hideModal=function(t){try{$("#"+t).modal("hide")}catch(e){$("#"+t).hide()}},this.cronapi.screen.showIonicModal=function(t){$("#"+t).data("cronapp-modal")&&$("#"+t).data("cronapp-modal").remove(),this.cronapi.$scope.$ionicModal.fromTemplateUrl(t,{scope:this.cronapi.$scope,animation:"slide-in-up"}).then(function(e){$("#"+t).data("cronapp-modal",e),e.show()})},this.cronapi.screen.hideIonicModal=function(t){if($("#"+t).data("cronapp-modal")){$("#"+t).data("cronapp-modal").remove(),$("#"+t).data("cronapp-modal",null)}},this.cronapi.screen.isShownIonicModal=function(t){if($("#"+t).data("cronapp-modal")){return $("#"+t).data("cronapp-modal").isShown()}return!1},this.cronapi.screen.searchIds=function(){},this.cronapi.screen.showComponent=function(t){$("#"+t).get(0).style.setProperty("display","block","important")},this.cronapi.screen.hideComponent=function(t){$("#"+t).get(0).style.setProperty("display","none","important")},this.cronapi.screen.disableComponent=function(t){$.each($("#"+t).find("*").addBack(),function(t,e){$(e).prop("disabled",!0)})},this.cronapi.screen.enableComponent=function(t){$.each($("#"+t).find("*").addBack(),function(t,e){$(e).prop("disabled",!1)})},this.cronapi.screen.focusComponent=function(t){this.cronapi.$scope.safeApply(function(){tinyMCE&&void 0!==tinyMCE.get(t)?tinyMCE.get(t).focus():$("#"+t).find("*").addBack().focus()})},this.cronapi.screen.changeAttrValue=function(t,e,n){$("#"+t).attr(e,n)},this.cronapi.screen.logout=function(){void 0!=this.cronapi.$scope.logout&&this.cronapi.$scope.logout()},this.cronapi.screen.refreshDatasource=function(t,e){1==e||"true"==e?this[t].search(this[t].terms,this[t].caseInsensitive):this[t].search("",this[t].caseInsensitive)},this.cronapi.dateTime={},this.cronapi.dateTime.utcTimestamp=!0,this.cronapi.dateTime.formats=function(){var t=[];return t="pt_br"==this.cronapi.$translate.use()?["DD/MM/YYYY HH:mm:ss","DD/MM/YYYY","DD-MM-YYYY HH:mm:ss","DD-MM-YYYY"]:["MM/DD/YYYY HH:mm:ss","MM/DD/YYYY","MM-DD-YYYY HH:mm:ss","MM-DD-YYYY"],t.push("YYYY-MM-DDTHH:mm:ss"),t.push("HH:mm:ss"),t.push("MMMM"),t},this.cronapi.dateTime.getMomentObj=function(t){var e=moment;if(this.cronapi.dateTime.utcTimestamp&&(e=moment.utc),t instanceof moment)return t;if(t instanceof Date)return e(t);var n=this.cronapi.dateTime.formats(),i=null;for(var a in n)if(i=e(t,n[a]),i.isValid())break;return i},this.cronapi.dateTime.getSecond=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("second"):0},this.cronapi.dateTime.getMinute=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("minute"):0},this.cronapi.dateTime.getHour=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("hour"):0},this.cronapi.dateTime.getYear=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("year"):0},this.cronapi.dateTime.getMonth=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("month")+1:0},this.cronapi.dateTime.getDay=function(t){var e=this.cronapi.dateTime.getMomentObj(t);return e?e.get("date"):0},this.cronapi.dateTime.getSecondsBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"seconds")},this.cronapi.dateTime.getMinutesBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"minutes")},this.cronapi.dateTime.getHoursBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"hours")},this.cronapi.dateTime.getDaysBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"days")},this.cronapi.dateTime.getMonthsBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"months")},this.cronapi.dateTime.getYearsBetweenDates=function(t,e){var n=this.cronapi.dateTime.getMomentObj(t),i=this.cronapi.dateTime.getMomentObj(e);return n.diff(i,"years")},this.cronapi.dateTime.incSecond=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("seconds",e).toDate()},this.cronapi.dateTime.incMinute=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("minutes",e).toDate()},this.cronapi.dateTime.incHour=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("hours",e).toDate()},this.cronapi.dateTime.incDay=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("days",e).toDate()},this.cronapi.dateTime.incMonth=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("months",e).toDate()},this.cronapi.dateTime.incYear=function(t,e){return this.cronapi.dateTime.getMomentObj(t).add("years",e).toDate()},this.cronapi.dateTime.getNow=function(){return moment().toDate()},this.cronapi.dateTime.formatDateTime=function(date,format){format=format.toLowerCase(),format.indexOf(":mm")>-1&&(format=this.cronapi.internal.replaceAll(format,":mm",":minutes")),format=this.cronapi.internal.replaceAll(format," ",'+" "+'),format=this.cronapi.internal.replaceAll(format,":",'+":"+');for(var dateVar=this.cronapi.dateTime.getMomentObj(date),dd=dateVar.get("date"),mm=dateVar.get("month")+1,yyyy=dateVar.get("year"),hh=dateVar.get("hour"),minutes=dateVar.get("minute"),ss=dateVar.get("second"),separator="",maskChars="dmy",i=0;i<format.length;i++)if(!maskChars.includes(format.charAt(i))){separator=format.charAt(i);var formatLower=this.cronapi.internal.replaceAll(format,separator,"+separator+");return eval(formatLower)}return""},this.cronapi.dateTime.newDate=function(t,e,n,i,a,r){var o=new Date;return o.setYear(t),o.setMonth(e-1),o.setDate(n),o.setHours(i),o.setMinutes(a),o.setSeconds(r),this.cronapi.dateTime.getMomentObj(o.toLocaleString()).toDate()},this.cronapi.text={},this.cronapi.text.prompt=function(t){return null},this.cronapi.xml={},this.cronapi.xml.newXMLEmpty=function(){return $.parseXML('<?xml version="1.0" encoding="UTF-8"?><root></root>')},this.cronapi.xml.newXMLEmptyWithRoot=function(t){var e=$.parseXML('<?xml version="1.0" encoding="UTF-8"?><root></root>');return e.removeChild(e.firstElementChild),e.appendChild(t),e},this.cronapi.xml.newXMLElement=function(t,e){var n=document.createElement(t);return n.textContent=e,n},this.cronapi.xml.addXMLElement=function(t,e){try{var n=e.cloneNode(!0);return t.appendChild(n),!0}catch(t){return!1}},this.cronapi.xml.XMLHasRootElement=function(t){return!(!t||!t.getRootNode())},this.cronapi.xml.XMLGetRootElement=function(t){return t instanceof XMLDocument?t.firstElementChild:t.getRootNode()},this.cronapi.xml.XMLDocumentToText=function(t){if(t instanceof XMLDocument)return $($($(t.firstElementChild).context.outerHTML).removeAttr("xmlns"))[0].outerHTML;if($(t).size()>1){var e="";return $.each($(t).toArray(),function(t,n){e+=$($(n)[0].outerHTML).removeAttr("xmlns")[0].outerHTML}),e}return $($($(t).context.outerHTML).removeAttr("xmlns"))[0].outerHTML},this.cronapi.xml.getChildren=function(t,e){return t instanceof XMLDocument?t.firstElementChild.toArray:e?e.localName?$(t).find(e.localName).toArray():$(t).find(e).toArray():$(t).children().toArray()},this.cronapi.xml.setAttribute=function(t,e,n){return!!e&&(t instanceof XMLDocument?(t.firstChild.setAttribute(e,n),!0):!!t&&(t.setAttribute(e,n),!0))},this.cronapi.xml.getAttributeValue=function(t,e){return e?t instanceof XMLDocument?t.firstChild.getAttribute(e)?t.firstChild.getAttribute(e):"":t&&e?t.getAttribute(e):"":""},this.cronapi.xml.getParentNode=function(t){return t instanceof XMLDocument?t.firstChild:t.parentNode},this.cronapi.xml.setElementContent=function(t,e){t instanceof XMLDocument&&(t.firstChild.textContent=e),t.textContent=e},this.cronapi.xml.getElementContent=function(t){return t instanceof XMLDocument?t.firstChild.innerText:t.innerText},this.cronapi.xml.removeElement=function(t,e){t instanceof XMLDocument?e?e instanceof HTMLUnknownElement?e.remove():$.each($(t.firstElementChild.children),function(t,n){n.localName==e&&n.remove()}):$.each($(t.firstElementChild.children),function(t,e){e.remove()}):e?e instanceof HTMLUnknownElement?e.remove():$.each($(t.children),function(t,n){n.localName==e&&n.remove()}):$.each($(t.children),function(t,e){e.remove()})},this.cronapi.xml.getElementName=function(t){return t instanceof XMLDocument?t.firstChild.localName:t.localName},this.cronapi.xml.renameElement=function(t,e){var n=t.outerHTML.replace(t.localName,e);n=n.replace("/"+t.localName,"/"+e),n=$(n).removeAttr("xmlns"),t.replaceWith(n[0])},this.cronapi.logic={},this.cronapi.logic.isNull=function(t){return null===t||void 0===t||void 0==t},this.cronapi.logic.isEmpty=function(t){return""===t},this.cronapi.logic.isNullOrEmpty=function(t){return this.cronapi.logic.isNull(t)||this.cronapi.logic.isEmpty(t)},this.cronapi.logic.typeOf=function(t,e){return"array"===e?Array.isArray(t):("object"!==e||!Array.isArray(t))&&typeof t===e},this.cronapi.i18n={},this.cronapi.i18n.translate=function(t,e){if(t){for(var n=this.cronapi.$translate.instant(t),i=0;i<e.length;i++){var a=e[i];if(null!=a&&void 0!==a){var r=new RegExp("\\{"+i+"\\}","g");n=n.replace(r,a)}}return n}},this.cronapi.internal={},this.cronapi.internal.setFile=function(t,e){this.cronapi.internal.fileToBase64(e,function(e){this.cronapi.screen.changeValueOfField(t,e)}.bind(this))},this.cronapi.internal.fileToBase64=function(t,e){var n=new FileReader;n.readAsDataURL(t),n.onload=function(t){var n=t.target.result.substr(t.target.result.indexOf("base64,")+"base64,".length);e(n)}},this.cronapi.internal.startCamera=function(t){function e(t,e){var n=window.innerWidth,i=window.innerHeight,a=0;return a=n/t,e*=a,t*=a,t>n&&(a=n/t,e*=a,t*=a),e>i&&(a=i/e,t*=a,e*=a),{width:t,height:e}}var n='<div class="camera-container" style="margin-left:-$marginleft$;margin-top:-$margintop$">                                    <div class="btn btn-success button button-balanced" id="cronapiVideoCaptureOk" style="position: absolute; z-index: 999999999;">                                        <span class="glyphicon glyphicon-ok icon ion-checkmark-round"></span>                                    </div>                                    <div class="btn btn-danger button button-assertive button-cancel-capture" id="cronapiVideoCaptureCancel" style="position: absolute; margin-left: 42px; z-index: 999999999;">                                        <span class="glyphicon glyphicon-remove icon ion-android-close"></span>                                    </div>                                    <video id="cronapiVideoCapture" style="height: $height$; width: $width$;" autoplay=""></video>                            </div>',i=null,a={video:!0};navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia(a).then(function(a){i=a;var r=e(a.getTracks()[0].getSettings().width,a.getTracks()[0].getSettings().height),o=r.width,c=r.height;try{o=parseInt(o/2),c=parseInt(c/2)}catch(t){}n=n.split("$height$").join(r.height+"px").split("$width$").join(r.width+"px").split("$marginleft$").join(o+"px").split("$margintop$").join(c+"px");var s=$(n);s.prependTo("body");var l=document.getElementById("cronapiVideoCapture");s.find("#cronapiVideoCaptureCancel").on("click",function(){null!=i&&i.getTracks().length>0&&i.getTracks()[0].stop(),$(s).remove()}.bind(this)),s.find("#cronapiVideoCaptureOk").on("click",function(){this.cronapi.internal.captureFromCamera(t,r.width,r.height),null!=i&&i.getTracks().length>0&&i.getTracks()[0].stop(),$(s).remove()}.bind(this)),l.src=window.URL.createObjectURL(a),l.play()}.bind(this))},this.cronapi.internal.downloadFileEntityMobile=function(t,e,n){var i,a,r=null;if(n)i=t.data[n][e],a=t.data[n];else try{i=t.active[e],a=t.active}catch(n){i=t[e],a=t}try{var r=JSON.parse(i)}catch(t){}if(r){var o=this.cronapi.internal.getAddressWithHostApp("/api/cronapi/filePreview/");window.open(o+r.path,"_system")}else if(i.indexOf("dropboxusercontent")>-1)window.open(i,"_system");else{var c="/api/cronapi/downloadFile",s=t.entity.split("/"),l=s[s.length-1];if(l.indexOf(":")>-1){for(var p="",u=s[3].split("."),h=0;h<u.length-1;h++)p+=u[h]+".";var d=l.split(":");l=p+d[d.length-1]}c+="/"+l,c+="/"+e;var f=a,m=t.getKeyValues(f),g=0;for(var v in m)c=0==g?c+"/"+f[v]:c+":"+f[v],g++;var o=this.cronapi.internal.getAddressWithHostApp(c);window.open(o,"_system")}},this.cronapi.internal.captureFromCamera=function(t,e,n){var i=document.createElement("canvas");i.width=e,i.height=n;var a=i.getContext("2d"),r=document.getElementById("cronapiVideoCapture");a.drawImage(r,0,0,e,n);var o=i.toDataURL().substr(22);this.cronapi.screen.changeValueOfField(t,o)},this.cronapi.internal.castBase64ToByteArray=function(t){for(var e=window.atob(t),n=e.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=e.charCodeAt(a);return i},this.cronapi.internal.castByteArrayToString=function(t){return String.fromCharCode.apply(null,new Uint16Array(t))},this.cronapi.internal.generatePreviewDescriptionByte=function(t){var e;try{e=JSON.parse(t)}catch(o){try{e=JSON.parse(this.cronapi.internal.castByteArrayToString(this.cronapi.internal.castBase64ToByteArray(t)))}catch(o){if(t&&t.indexOf("dropboxusercontent")>-1){e={};var n=t.split("/"),i=n[n.length-1].replace("?dl=0",""),a=i.split("."),r="."+a[a.length-1];e.fileExtension=r,e.name=i.replace(r,""),e.contentType="file/"+r.replace(".","")}}}if(e){e.name.length>25&&(e.name=e.name.substr(0,22)+"...");var o="<b>Nome:</b> <br/>"+e.name+"<br/>";return o+="<b>Content-Type:</b> <br/>"+e.contentType+"<br/>",o+="<b>Extensão:</b> <br/>"+e.fileExtension+"<br/>"}},this.cronapi.internal.downloadFileEntity=function(t,e,n){var i,a,r=null;if(n)i=t.data[n][e],a=t.data[n];else try{i=t.active[e],a=t.active}catch(n){i=t[e],a=t}try{var r=JSON.parse(i)}catch(t){}if(r)window.open("/api/cronapi/filePreview/"+r.path);else if(i.indexOf("dropboxusercontent")>-1)window.open(i);else{var o="/api/cronapi/downloadFile",c=t.entity.split("/"),s=c[c.length-1];if(s.indexOf(":")>-1){for(var l="",p=c[3].split("."),u=0;u<p.length-1;u++)l+=p[u]+".";var h=s.split(":");s=l+h[h.length-1]}o+="/"+s,o+="/"+e;var d=JSON.parse(localStorage.getItem("_u")),f=a,m=this.cronapi.internal.getAddressWithHostApp(o);this.$promise=this.cronapi.$scope.$http({method:"POST",url:m,data:f?JSON.stringify(f):null,responseType:"blob",headers:{"Content-Type":"application/json","X-AUTH-TOKEN":d.token}}).success(function(t,e,n,i){n=n();var a=n["x-filename"]||"download.bin",r=(n["content-type"],window.URL||window.webkitURL||window.mozURL||window.msURL);try{var o=document.createElement("a");if("download"in o){var c=r.createObjectURL(t);o.setAttribute("href",c),o.setAttribute("download",a);var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(s)}}catch(t){console.log("Error downloading file"),console.log(t)}}.bind(this)).error(function(t,e,n,i){console.log("Error downloading file")}.bind(this))}},this.cronapi.internal.uploadFile=function(t,e,n){if(e){var i=new FormData;i.append("file",e);var a=JSON.parse(localStorage.getItem("_u")),r=this.cronapi.internal.getAddressWithHostApp("/api/cronapi/uploadFile");this.$promise=this.cronapi.$scope.$http({method:"POST",url:r,data:i,headers:{"Content-Type":void 0,"X-AUTH-TOKEN":a.token},onProgress:function(t){if(t.lengthComputable){var e=t.loaded/t.total*100|0,i=$("#"+n);if(i.length>0)if("bootstrapProgress"==i.data("type"))e<100?(i.show(),i.find(".progress-bar").css("width",e+"%")):(i.hide(),i.find(".progress-bar").css("width","0%"));else{var a=document.getElementById(n);a.value=a.innerHTML=e}}}}).success(function(e,n,i,a){this.cronapi.screen.changeValueOfField(t,e.jsonString)}.bind(this)).error(function(t,e,n,i){alert("Error uploading file")}.bind(this))}},this.cronapi.object={},this.cronapi.object.getProperty=function(t,e){var n=e.split(".");if(n.length>1){var i=function(t,e,n){return n||(n=0),void 0===t[e[n]]&&(t[e[n]]={}),n++,n<e.length?i(t[e[n-1]],e,n):t[e[n-1]]};return i(t,n,0)}return t[e]},this.cronapi.object.setProperty=function(t,e,n){var i=e.split(".");if(i.length>1){var a=function(t,e,n,i){i||(i=0),void 0===t[e[i]]&&(t[e[i]]={}),i++,i<e.length?a(t[e[i-1]],e,n,i):t[e[i-1]]=n};a(t,i,n,0)}else t[e]=n},this.cronapi.object.createObjectFromString=function(t){return JSON.parse(t)},this.cronapi.cordova={},this.cronapi.cordova.vibrate=function(t){navigator.vibrate(t)},this.cronapi.cordova.device={},this.cronapi.cordova.device.getFirebaseToken=function(t,e){window.FirebasePlugin.getToken(t,e)},this.cronapi.cordova.device.getDeviceInfo=function(t){return window.device[t]},this.cronapi.cordova.geolocation={},this.cronapi.cordova.geolocation.getCurrentPosition=function(t,e){navigator.geolocation.getCurrentPosition(t,e)},this.cronapi.cordova.geolocation.watchPosition=function(t,e,n,i,a){return navigator.geolocation.watchPosition(callbackSuccess,callbackError,{maximumAge:n,timeout:i,enableHighAccuracy:a})},this.cronapi.cordova.geolocation.clearWatchPosition=function(t){navigator.geolocation.clearWatch(t)},this.cronapi.cordova.camera={},this.cronapi.cordova.camera.getPicture=function(t,e,n,i,a){void 0!==a&&null!==a||(a=0),navigator.camera.getPicture(t,e,{destinationType:n,sourceType:i,mediaType:a})},this.cronapi.cordova.camera.qrCodeScanner=function(t,e,n,i){cordova.plugins.barcodeScanner.scan(function(t){n(t.text)},function(t){i(t)},{preferFrontCamera:!1,showFlipCameraButton:!0,showTorchButton:!0,torchOn:!0,saveHistory:!0,prompt:e,resultDisplayDuration:500,formats:t,orientation:"portrait",disableAnimations:!0,disableSuccessBeep:!1})},this.cronapi.cordova.file={},this.cronapi.cordova.file.getDirectory=function(t){var e;return"0"==t?e=cordova.file.dataDirectory:(e=cordova.file.externalApplicationStorageDirectory,e||(e=cordova.file.externalDataDirectory),e||(e=cordova.file.syncedDataDirectory)),e},this.cronapi.cordova.file.removeFile=function(t,e,n){window.resolveLocalFileSystemURL(t,function(t){t.remove(function(t){e&&e(t)}.bind(this),n)}.bind(this),n)},this.cronapi.cordova.file.readFile=function(t,e,n,i){window.resolveLocalFileSystemURL(t,function(t){t.file(function(t){var n=new FileReader;switch(n.onloadend=function(t){e(this.result)},i){case"ARRAYBUFFER":n.readAsArrayBuffer(t);break;case"TEXT":n.readAsText(t);break;case"BINARYSTRING":n.readAsBinaryString(t);break;case"DATAURL":n.readAsDataURL(t);break;default:n.readAsText(t)}}.bind(this),n)}.bind(this),n)},this.cronapi.cordova.file.createFile=function(t,e,n,i,a){t||getDirectory(0);window.resolveLocalFileSystemURL(t,function(r){console.log(t),r.getFile(e,{create:!0},function(t){t.createWriter(function(t){t.onwriteend=function(t){console.log('Write of file "'+e+'"" completed.')},t.onerror=function(t){console.log("Write failed: "+t.toString())};var a=new Blob([n],{type:"text/plain"});t.write(a),i&&setTimeout(function(){i()}.bind(this),500)}.bind(this),a)}.bind(this),a)}.bind(this),a)},this.cronapi.cordova.file.createDirectory=function(t,e,n,i){window.resolveLocalFileSystemURL(t,function(t){parentEntry.getDirectory(e,{create:!0},function(t){n&&n(t)}.bind(this),i)}.bind(this),i)},this.cronapi.cordova.storage={},this.cronapi.cordova.storage.setStorageItem=function(t,e){var n=window.localStorage;n?n.setItem(t,e):console.error("Local Storage not Found!")},this.cronapi.cordova.storage.getStorageItem=function(t){var e=window.localStorage;if(e)return e.getItem(t);console.error("Local Storage not Found!")},this.cronapi.cordova.storage.removeStorageItem=function(t){var e=window.localStorage;e?e.removeItem(t):console.error("Local Storage not Found!")},this.cronapi.cordova.connection={},this.cronapi.cordova.connection.getConnection=function(){return navigator.connection.type},this.cronapi.cordova.connection.verifyConnection=function(t){return navigator.connection.type==t},this.cronapi.cordova.database={},this.cronapi.cordova.database.nameDefault="cronappDB",this.cronapi.cordova.database.openDatabase=function(t){return t?window.openDatabase(t,"1.0",t,1e6):window.openDatabase(this.cronapi.cordova.database.nameDefault,"1.0",this.cronapi.cordova.database.nameDefault,1e6)},this.cronapi.cordova.database.executeSql=function(t,e,n,i,a){this.cronapi.cordova.database.openDatabase(t).transaction(function(t){t.executeSql(e,n,function(t,e){i.call(this,Object.values(e.rows))}.bind(this))}.bind(this),function(t){console.log(t),a(t)}.bind(this))},this.cronapi.internal.ptDate=function(t){var e=t[1],n=t[2],i=t[3],a=t[5],r=t[6],o=t[7];return a?new Date(i,n-1,e,a,r,o):new Date(i,n-1,e,0,0,0)},this.cronapi.internal.enDate=function(t){var e=t[1],n=t[2],i=t[3],a=t[5],r=t[6],o=t[7];return a?new Date(i,e-1,n,a,r,o):new Date(i,e-1,n,0,0,0)},this.cronapi.internal.parseBoolean=function(t){return!!t&&("boolean"==typeof t?t:"1"==(t=t.toString().toLowerCase().trim())||"true"==t)},this.cronapi.internal.removeAccents=function(t){var e="áàãâäéèêëíìîïóòõôöúùûüçÁÀÃÂÄÉÈÊËÍÌÎÏÓÒÕÖÔÚÙÛÜÇ",n="";for(i=0;i<t.length;i++)e.search(t.substr(i,1))>=0?n+="aaaaaeeeeiiiiooooouuuucAAAAAEEEEIIIIOOOOOUUUUC".substr(e.search(t.substr(i,1)),1):n+=t.substr(i,1);return n},this.cronapi.internal.arrayRemove=function(t,e){var n=this.cronapi.internal.arrayIndexOf(t,e);-1!=n&&t.splice(n,1)},this.cronapi.internal.arrayIndexOf=function(t,e){var n=-1;return $(t).each(function(t){e==this&&(n=t)}),n},this.cronapi.internal.replaceAll=function(t,e,n){return t.toString().split(e).join(n)},this.cronapi.internal.getWindowHeight=function(){$(window).height()},this.cronapi.internal.getWindowWidth=function(){$(window).width()},this.cronapi.internal.getAddressWithHostApp=function(t){var e=window.hostApp||"";if(e=e.endsWith("/")?e.substr(0,e.length-1):e,t){var n=t.startsWith("/")?t.substr(1):t;e=""===e?n:e+"/"+n}return e},this.cronapi.internal.Url={encode:function(t){return t?escape(this.cronapi.internal.Url._utf8_encode(t)):""},decode:function(t){return t?this.cronapi.internal.Url._utf8_decode(unescape(t)):""},_utf8_encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var i=t.charCodeAt(n);i<128?e+=String.fromCharCode(i):i>127&&i<2048?(e+=String.fromCharCode(i>>6|192),e+=String.fromCharCode(63&i|128)):(e+=String.fromCharCode(i>>12|224),e+=String.fromCharCode(i>>6&63|128),e+=String.fromCharCode(63&i|128))}return e},_utf8_decode:function(t){for(var e="",n=0,i=c1=c2=0;n<t.length;)i=t.charCodeAt(n),i<128?(e+=String.fromCharCode(i),n++):i>191&&i<224?(c2=t.charCodeAt(n+1),
e+=String.fromCharCode((31&i)<<6|63&c2),n+=2):(c2=t.charCodeAt(n+1),c3=t.charCodeAt(n+2),e+=String.fromCharCode((15&i)<<12|(63&c2)<<6|63&c3),n+=3);return e}},this.cronapi.internal.stringToJs=function(t){return(t+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},this.cronapi.internal.getErrorMessage=function(t,e){try{var n=JSON.parse(t);if(n&&n.error)return n.error}catch(t){}return e},this.cronapi.util.upload=function(t,e,n,i,a){this.UploadService.upload({description:e,id:t,filter:n,maxSize:i,multiple:a,scope:this})},this.cronapi.chart={},this.cronapi.chart.createChart=function(t,e,n,i,a){function r(){return p<l.length?p++:p=0,p}function o(){""==h.data.datasets[0].label&&(void 0==h.options.legend?(h.options.legend={},h.options.legend.display=!1):h.options.legend.display=!1)}function c(t){for(var e=[],n=4;n<t.length;n++)t[n].label?t[n].options?(t[n].data?e.push(cronapi.chart.createDataset(t[n].label,t[n].data,t[n].options)):e.push(cronapi.chart.createDataset(t[n].label,t[n],null)),e.push(cronapi.chart.createDataset(t[n].label,t[n].data,t[n].options))):e.push(cronapi.chart.createDataset(t[n].label,t[n].data,null)):t[n].options?(t[n].data?e.push(cronapi.chart.createDataset(null,t[n].data,t[n].options)):e.push(cronapi.chart.createDataset(null,t[n],t[n].options)),e.push(cronapi.chart.createDataset(null,t[n].data,t[n].options))):t[n].data?e.push(cronapi.chart.createDataset(null,t[n].data,null)):e.push(cronapi.chart.createDataset(null,t[n],null));return e}function s(){void 0==h.options?(h.options={},h.options.scales={},h.options.scales.yAxes=[{ticks:{beginAtZero:!0}}]):void 0==h.options.scales&&(h.options.scales={},h.options.scales.yAxes=[{ticks:{beginAtZero:!0}}])}var l=["#FF5C00","#0E53A7","#48DD00","#FFD500","#7309AA","#CD0074","#00AF64","#BF8230","#F16D95","#A65000","#A65000","#AF66D5"],p=0,u=document.getElementById(t);u._chart&&u._chart.destroy(),u.getContext("2d");var h={};if(h.type=e,h.data=[],h.options={},Array.isArray(n)?h.data.labels=n:h.data.labels=JSON.parse(n),h.data.datasets=[],Array.isArray(i))h.options=i;else if(""!=i&&null!=i)try{h.options=JSON.parse(i)}catch(t){h.options={},console.log(t)}else h.options={};switch(e){case"line":h.data.datasets=c(arguments),$.each(h.data.datasets,function(t,e){e.fill=!1,e.backgroundColor=l[r()],e.borderColor=e.backgroundColor,s(),o()});break;case"bar":h.data.datasets=c(arguments),$.each(h.data.datasets,function(t,e){e.backgroundColor=l[r()],e.borderColor=e.backgroundColor}),s(),o();break;case"doughnut":case"pie":case"polarArea":var d=c(arguments);$.each(d,function(t,e){var n={};n=d[t],n.backgroundColor=[],n.borderColor=[],$.each(n.data,function(t,e){n.backgroundColor.push(l[r()])}),n.borderColor=n.backgroundColor,h.data.datasets.push(n),p=0})}var f=new Chart(u,h);u._chart=f},this.cronapi.chart.createDataset=function(t,e,n){var i={};return i.label=t||"",Array.isArray(e)?i.data=e:i.data=e?JSON.parse(e):[],Array.isArray(n)?i.options=n:i.options=JSON.parse(n),i}}).bind(window)();